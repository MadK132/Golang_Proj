<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ –∫—É—Ä—Å—ã</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    .wrapper {
      display: flex;
      width: 100%;
    }

    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .sidebar {
      width: 250px;
      background: #000000;
      color: white;
      padding-top: 80px; /* Space for header */
      position: fixed;
      left: 0;
      height: 100%;
      z-index: 99;
    }

    .main-content {
      margin-left: 250px;
      width: calc(100% - 250px);
      padding: 20px;
      padding-top: 80px; /* Space for header */
      flex: 1;
    }

    .sidebar-menu {
      padding: 0;
      list-style: none;
    }

    .sidebar-menu li {
      padding: 15px 20px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .sidebar-menu li a {
      color: white;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sidebar-menu li:hover {
      background: rgba(255,255,255,0.1);
    }

    .progress-section {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .progress-details {
      font-size: 14px;
    }

    .progress-details p {
      margin: 5px 0;
    }

    .current-level {
      background-color: #28a745;
      color: white;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 4px;
    }

    .progress-bar {
      background-color: #f0f0f0;
      height: 20px;
      border-radius: 10px;
      overflow: hidden;
    }

    .progress-fill {
      background-color: #28a745;
      height: 100%;
      transition: width 0.3s ease;
    }

    .card {
      border: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .card-title {
      color: #007bff; /* —Å–∏–Ω–∏–π –¥–ª—è —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã */
      margin-bottom: 1rem;
    }

    /* –¶–≤–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ */
    .dark-mode .card-title {
      color: #00d084; /* –º—è—Ç–Ω–æ-–∑–µ–ª–µ–Ω—ã–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
    }

    .list-unstyled li {
      margin-bottom: 0.8rem;
      color: #666;
    }

    /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ —Å–ø–∏—Å–∫–æ–≤ –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ */
    .dark-mode .list-unstyled li {
      color: #b0b0b0;
    }

    .lead {
      color: #666;
      margin-bottom: 2rem;
    }

    .footer {
      margin-top: auto;
      background-color: #000000;
      color: white;
      padding: 20px 0;
    }

    .card-img-top {
      height: 200px;
      object-fit: cover;
    }

    .card {
      border: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body class="light-mode">

<header class="header py-3">
  <div class="container d-flex justify-content-between">
    <nav class="nav">
      <div class="nav-logo" style="padding-right: 20%">
        <p>STUDY</p>
      </div>
      <div class="nav-menu" id="navMenu">
        <ul>
          <li><a href="/" class="link">Home</a></li>
          <li><a href="/courses" class="link">Courses</a></li>
          <li><a href="/contact" class="link">Contact us</a></li>
        </ul>
      </div>
      <div class="nav-menu" id="navMenuu">
        <div class="nav-button">
          <ul>
            <li><a href="/login" id="Login" class="link">Log In / Sign Up</a></li>
            <li><span id="userGreeting" style="display: none;"></span></li>
          </ul>
        </div>
      </div>
    </nav>
    <button id="modeToggle" class="btn btn-light position-relative top-0 right-0 m-3">üåô</button>
    <button class="btn" id="logoutBtn" style="display: none;" onclick="logout()">Log Out</button>
  </div>
</header>

<div class="wrapper">
  <nav class="sidebar">
    <div class="progress-section">
      <h6>–ö—É—Ä—Å –ø—Ä–æ–≥—Ä–µ—Å—ñ: <span id="totalProgressText">0%</span></h6>
      <div class="progress-bar">
        <div class="progress-fill" id="totalProgress" style="width: 0%"></div>
      </div>
      <div class="progress-details">
        <div>
          <p>–í–∏–¥–µ–æ: <span id="videoProgressText">0/0 –≤–∏–¥–µ–æ –∞—è“õ—Ç–∞–ª–¥—ã</span></p>
          <p>–¢–µ—Å—Ç—Ç–µ—Ä: <span id="quizProgressText">0/0 —Ç–µ—Å—Ç –∞—è“õ—Ç–∞–ª–¥—ã</span></p>
          <p>–¢—ñ–ª –¥–µ“£–≥–µ–π—ñ: <span id="levelText">–ê–Ω—ã“õ—Ç–∞–ª–º–∞“ì–∞–Ω</span></p>
        </div>
      </div>
    </div>
    <ul class="sidebar-menu">
      <li>
        <a href="/videokz">
          <span>üì∫</span> –í–∏–¥–µ–æ—Å–∞–±–∞“õ—Ç–∞—Ä
        </a>
      </li>
      <li>
        <a href="/quizkz">
          <span>üìù</span> –ñ–∞—Ç—Ç—ã“ì—É–ª–∞—Ä
        </a>
      </li>
      <li>
        <a href="/kazakh-quiz">
          <span>üéØ</span> –î–µ“£–≥–µ–π —Ç–µ—Å—Ç—ñ
        </a>
      </li>
    </ul>
  </nav>

  <div class="main-content">
    <div class="container">
      <h1 style="text-align: center">“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ –∫—É—Ä—Å—ã</h1>

      <div class="row mt-4">
        <div class="col-md-4 mb-4">
          <div class="card h-100">
            <img src="/static/–ì—Ä–∞–º–º.jpg" class="card-img-top" alt="–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞">
            <div class="card-body">
              <h5 class="card-title">“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞—Å—ã</h5>
              <p class="card-text">“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ –Ω–µ–≥—ñ–∑–≥—ñ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞—Å—ã–Ω “Ø–π—Ä–µ–Ω—ñ“£—ñ–∑: —Å–µ–ø—Ç—ñ–∫—Ç–µ—Ä, –µ—Ç—ñ—Å—Ç—ñ–∫ —à–∞“õ—Ç–∞—Ä—ã, –∑–∞—Ç –µ—Å—ñ–º–¥–µ—Ä –∂”ô–Ω–µ —Ç–∞“ì—ã –±–∞—Å“õ–∞–ª–∞—Ä.</p>
              <ul class="list-unstyled">
                <li>‚úì 7 —Å–µ–ø—Ç—ñ–∫</li>
                <li>‚úì 3 –µ—Ç—ñ—Å—Ç—ñ–∫ —à–∞“ì—ã</li>
                <li>‚úì –ó–∞—Ç –µ—Å—ñ–º —Ç“Ø—Ä–ª–µ—Ä—ñ</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-4 mb-4">
          <div class="card h-100">
            <img src="/static/–ê–π—Ç—ã–ª—ã–º.jpg" class="card-img-top" alt="–ü—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ">
            <div class="card-body">
              <h5 class="card-title">–ê–π—Ç—ã–ª—ã–º</h5>
              <p class="card-text">“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ –¥—ã–±—ã—Å—Ç–∞—Ä—ã –º–µ–Ω —Å”©–∑–¥–µ—Ä—ñ–Ω –¥“±—Ä—ã—Å –∞–π—Ç—É–¥—ã “Ø–π—Ä–µ–Ω—ñ“£—ñ–∑.</p>
              <ul class="list-unstyled">
                <li>‚úì 42 ”ô—Ä—ñ–ø</li>
                <li>‚úì –°”©–∑ –µ–∫–ø—ñ–Ω—ñ</li>
                <li>‚úì –°”©–π–ª–µ–º –∏–Ω—Ç–æ–Ω–∞—Ü–∏—è—Å—ã</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-4 mb-4">
          <div class="card h-100">
            <img src="/static/–ö–æ—Ä.jpg" class="card-img-top" alt="–°–ª–æ–≤–∞—Ä–Ω—ã–π –∑–∞–ø–∞—Å">
            <div class="card-body">
              <h5 class="card-title">–°”©–∑–¥—ñ–∫ “õ–æ—Ä</h5>
              <p class="card-text">–ë—ñ–∑–¥—ñ“£ —Ç–∞“õ—ã—Ä—ã–ø—Ç—ã“õ —Å–∞–±–∞“õ—Ç–∞—Ä –∞—Ä“õ—ã–ª—ã —Å”©–∑–¥—ñ–∫ “õ–æ—Ä—ã“£—ã–∑–¥—ã –∫–µ“£–µ–π—Ç—ñ“£—ñ–∑.</p>
              <ul class="list-unstyled">
                <li>‚úì –ù–µ–≥—ñ–∑–≥—ñ —Å”©–∑–¥–µ—Ä</li>
                <li>‚úì –¢“±—Ä–∞“õ—Ç—ã —Ç—ñ—Ä–∫–µ—Å—Ç–µ—Ä</li>
                <li>‚úì –°”©–π–ª–µ—É –º”ô–Ω–µ—Ä—ñ</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-2">
        <div class="col-md-12 mb-4">
          <div class="card h-100">
            <div class="card-body d-flex">
              <div class="col-md-4">
                <img src="/static/–ü—Ä–∞–∫.jpg" class="img-fluid rounded" alt="–ü—Ä–∞–∫—Ç–∏–∫–∞">
              </div>
              <div class="col-md-8">
                <h5 class="card-title">–¢—ñ–ª –ø—Ä–∞–∫—Ç–∏–∫–∞—Å—ã</h5>
                <p class="card-text">–ë—ñ–∑–¥—ñ“£ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤—Ç—ñ –∂–∞—Ç—Ç—ã“ì—É–ª–∞—Ä –º–µ–Ω —Ç–µ—Å—Ç—Ç–µ—Ä –∞—Ä“õ—ã–ª—ã “õ–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω “Ø–Ω–µ–º—ñ –∂–∞—Ç—Ç—ã“ì—ã“£—ã–∑.</p>
                <div class="row">
                  <div class="col-md-6">
                    <ul class="list-unstyled">
                      <li>‚úì –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤—Ç—ñ –∂–∞—Ç—Ç—ã“ì—É–ª–∞—Ä</li>
                      <li>‚úì –ì—Ä–∞–º–º–∞—Ç–∏–∫–∞–ª—ã“õ —Ç–µ—Å—Ç—Ç–µ—Ä</li>
                    </ul>
                  </div>
                  <div class="col-md-6">
                    <ul class="list-unstyled">
                      <li>‚úì –°”©–∑–¥—ñ–∫ “õ–æ—Ä —Ç–µ—Å—Ç—Ç–µ—Ä—ñ</li>
                      <li>‚úì –î–µ“£–≥–µ–π –∞–Ω—ã“õ—Ç–∞—É —Ç–µ—Å—Ç—ñ</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<footer class="footer text-center">
  <p class="m-0">SE-2304. All Rights Reserved.</p>
</footer>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
  const defaultVideoLessons = [
      {
          id: 'video1',
          title: '“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω–µ –∫—ñ—Ä—ñ—Å–ø–µ',
          description: '“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ –Ω–µ–≥—ñ–∑–≥—ñ “±“ì—ã–º–¥–∞—Ä—ã.',
          videoUrl: 'https://www.youtube.com/embed/example1'
      },
      {
          id: 'video2',
          title: '”ò–ª—ñ–ø–±–∏ –∂”ô–Ω–µ –∞–π—Ç—ã–ª—ã–º',
          description: '“ö–∞–∑–∞“õ ”ô–ª—ñ–ø–±–∏—ñ –º–µ–Ω –∞–π—Ç—ã–ª—ã–º.',
          videoUrl: 'https://www.youtube.com/embed/example2'
      },
      {
          id: 'video3',
          title: '–ù–µ–≥—ñ–∑–≥—ñ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞',
          description: '“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞—Å—ã.',
          videoUrl: 'https://www.youtube.com/embed/example3'
      }
  ];

  const defaultQuizLessons = [
      {
          id: 'quiz1',
          title: '–ù–µ–≥—ñ–∑–≥—ñ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞',
          description: '“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ –Ω–µ–≥—ñ–∑–≥—ñ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞—Å—ã–Ω —Ç–µ–∫—Å–µ—Ä—É.'
      },
      {
          id: 'quiz2',
          title: '–ó–∞—Ç –µ—Å—ñ–º',
          description: '–ó–∞—Ç –µ—Å—ñ–º —Ç–µ—Å—Ç—ñ.'
      },
      {
          id: 'quiz3',
          title: '–°—ã–Ω –µ—Å—ñ–º',
          description: '–°—ã–Ω –µ—Å—ñ–º —Ç–µ—Å—Ç—ñ.'
      },
      {
          id: 'quiz4',
          title: '–û—Å—ã —à–∞“õ –µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä—ñ',
          description: '–û—Å—ã —à–∞“õ –µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä—ñ —Ç–µ—Å—Ç—ñ.'
      },
      {
          id: 'quiz5',
          title: '”®—Ç–∫–µ–Ω —à–∞“õ –µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä—ñ',
          description: '”®—Ç–∫–µ–Ω —à–∞“õ –µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä—ñ —Ç–µ—Å—Ç—ñ.'
      }
  ];

  if (!localStorage.getItem('videoLessons')) {
      localStorage.setItem('videoLessons', JSON.stringify(defaultVideoLessons));
  }
  if (!localStorage.getItem('quizLessons')) {
      localStorage.setItem('quizLessons', JSON.stringify(defaultQuizLessons));
  }

  document.addEventListener('DOMContentLoaded', function() {
    const savedTheme = localStorage.getItem("theme");
    const body = document.body;
    const sidebar = document.querySelector(".sidebar");
    const modeToggleButton = document.getElementById("modeToggle");
    const progressFill = document.querySelector(".progress-fill");

    if (savedTheme) {
        body.classList.remove("light-mode", "dark-mode");
        body.classList.add(savedTheme);
        sidebar.classList.remove("light-mode", "dark-mode");
        sidebar.classList.add(savedTheme);

        if (savedTheme === "dark-mode") {
            modeToggleButton.textContent = "üåû";
            progressFill.style.backgroundColor = "#4CAF50"; // –∑–µ–ª–µ–Ω—ã–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
        } else {
            modeToggleButton.textContent = "üåô";
            progressFill.style.backgroundColor = "#007bff"; // —Å–∏–Ω–∏–π –¥–ª—è —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã
        }
    } else {
        body.classList.add("light-mode");
        sidebar.classList.add("light-mode");
        modeToggleButton.textContent = "üåô";
        progressFill.style.backgroundColor = "#007bff"; // —Å–∏–Ω–∏–π –¥–ª—è —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    }

    modeToggleButton.addEventListener("click", toggleMode);

    const currentUser = localStorage.getItem("currentUser");
    if (currentUser) {
      document.getElementById("Login").style.display = "none";
      document.getElementById("userGreeting").style.display = "inline";
      document.getElementById("userGreeting").textContent = `${currentUser}`;
      document.getElementById("logoutBtn").style.display = "inline";
    } else {
      document.getElementById("Login").style.display = "inline";
      document.getElementById("userGreeting").style.display = "none";
      document.getElementById("logoutBtn").style.display = "none";
    }

    updateProgress();
  });

  function toggleMode() {
    const body = document.body;
    const modeToggleButton = document.getElementById("modeToggle");
    const sidebar = document.querySelector(".sidebar");
    const progressFill = document.querySelector(".progress-fill");
    const isLightMode = body.classList.contains("light-mode");

    if (isLightMode) {
        body.classList.remove("light-mode");
        body.classList.add("dark-mode");
        sidebar.classList.remove("light-mode");
        sidebar.classList.add("dark-mode");
        progressFill.style.backgroundColor = "#4CAF50"; // –∑–µ–ª–µ–Ω—ã–π –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
        modeToggleButton.textContent = "üåû";
        localStorage.setItem("theme", "dark-mode");
    } else {
        body.classList.remove("dark-mode");
        body.classList.add("light-mode");
        sidebar.classList.remove("dark-mode");
        sidebar.classList.add("light-mode");
        progressFill.style.backgroundColor = "#007bff"; // —Å–∏–Ω–∏–π –¥–ª—è —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã
        modeToggleButton.textContent = "üåô";
        localStorage.setItem("theme", "light-mode");
    }
  }

  function logout() {
    localStorage.removeItem("currentUser");
    window.location.reload();
  }

  async function updateProgress() {
    const currentUser = localStorage.getItem('currentUser');
    if (!currentUser) return;

    const videoLessons = JSON.parse(localStorage.getItem('videoLessons'));
    const quizLessons = JSON.parse(localStorage.getItem('quizLessons'));
    let videoProgress = 0;

    try {
        const videoResponse = await fetch(`videos/completed/${currentUser}/kazakh`);
        if (videoResponse.ok) {
            const videoData = await videoResponse.json();
            const completedCount = videoData.length || 0;
            document.getElementById('videoProgressText').textContent = 
                `${completedCount}/${videoLessons.length} –≤–∏–¥–µ–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ`;
            videoProgress = completedCount;
        }

        const quizResponse = await fetch(`/quizzes/completed/${currentUser}/kazakh`);
        if (quizResponse.ok) {
            const quizData = await quizResponse.json();
            const completedQuizzes = quizData.length || 0;
            document.getElementById('quizProgressText').textContent = 
                `${completedQuizzes}/${quizLessons.length} —Ç–µ—Å—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ`;

            const totalCompleted = videoProgress + completedQuizzes;
            const totalItems = videoLessons.length + quizLessons.length;
            const totalProgress = (totalCompleted / totalItems) * 100;
            document.getElementById('totalProgress').style.width = `${totalProgress}%`;
            document.getElementById('totalProgressText').textContent = 
                `${Math.round(totalProgress)}%`;
        }

        const levelResponse = await fetch(`/update-progress/${currentUser}/kazakh`);
        if (levelResponse.ok) {
            const levelData = await levelResponse.json();
            document.getElementById('levelText').textContent = 
                levelData.language_level || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
        }

    } catch (error) {
        console.error('Error updating progress:', error);
    }
  }

  function showResources() {
    alert('Resources section coming soon!');
  }

  function showNotes() {
    alert('Notes section coming soon!');
  }

  function showGrammar() {
    alert('–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ –±”©–ª—ñ–º—ñ –∂–∞“õ—ã–Ω–¥–∞ “õ–æ–ª–∂–µ—Ç—ñ–º–¥—ñ –±–æ–ª–∞–¥—ã!');
  }

  function showVocabulary() {
    alert('–°”©–∑–¥—ñ–∫ “õ–æ—Ä –±”©–ª—ñ–º—ñ –∂–∞“õ—ã–Ω–¥–∞ “õ–æ–ª–∂–µ—Ç—ñ–º–¥—ñ –±–æ–ª–∞–¥—ã!');
  }
</script>

</body>
</html>
