<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ –∫—É—Ä—Å—ã - –ñ–∞—Ç—Ç—ã“ì—É–ª–∞—Ä</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* –¢–µ –∂–µ —Å—Ç–∏–ª–∏, —á—Ç–æ –∏ –≤ quiz.html */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .quiz-list {
            margin-top: 20px;
        }
        .quiz-item {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .completed {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
        .light-mode .quiz-item {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
        }

        /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
        .dark-mode .quiz-item {
            background-color: #2d2d2d;
            border: 1px solid #444;
        }
        .dark-mode .completed {
            background-color: #28a745;
            color: white;
        }
    </style>
</head>
<body class="light-mode">
    <header class="header py-3">
        <div class="container d-flex justify-content-between">
            <nav class="nav">
                <div class="nav-logo" style="padding-right: 20%">
                    <p>STUDY</p>
                </div>
            </nav>
            <button id="modeToggle" class="btn btn-light position-relative top-0 right-0 m-3">üåô</button>
        </div>
    </header>

    <div class="wrapper">
        <button onclick="window.location.href='/test'" 
                class="btn btn-secondary" 
                style="position: fixed; top: 80px; left: 20px; z-index: 1000;">
            <i class="fas fa-arrow-left"></i> –ê—Ä—Ç“õ–∞
        </button>

        <div class="main-content">
            <div class="quiz-container">
                <h2>–ñ–∞—Ç—Ç—ã“ì—É–ª–∞—Ä</h2>
                <div id="quizList" class="quiz-list"></div>
            </div>
        </div>
    </div>

    <script>
        const defaultQuizLessons = [
            {
                id: 'quiz1',
                title: '–ù–µ–≥—ñ–∑–≥—ñ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞',
                description: '“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ –Ω–µ–≥—ñ–∑–≥—ñ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞—Å—ã–Ω —Ç–µ–∫—Å–µ—Ä—É.'
            },
            {
                id: 'quiz2',
                title: '–ó–∞—Ç –µ—Å—ñ–º',
                description: '–ó–∞—Ç –µ—Å—ñ–º –∂”ô–Ω–µ –æ–ª–∞—Ä–¥—ã“£ —Ç“Ø—Ä–ª–µ—Ä—ñ–Ω –±—ñ–ª—É —Ç–µ—Å—Ç—ñ.'
            },
            {
                id: 'quiz3',
                title: '–°—ã–Ω –µ—Å—ñ–º',
                description: '–°—ã–Ω –µ—Å—ñ–º –∂”ô–Ω–µ –æ–ª–∞—Ä–¥—ã“£ “õ–æ–ª–¥–∞–Ω—ã–ª—É—ã–Ω —Ç–µ–∫—Å–µ—Ä—É.'
            },
            {
                id: 'quiz4',
                title: '–û—Å—ã —à–∞“õ –µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä—ñ',
                description: '–û—Å—ã —à–∞“õ—Ç–∞“ì—ã –µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä–¥—ñ –∂—ñ–∫—Ç–µ—É —Ç–µ—Å—Ç—ñ.'
            },
            {
                id: 'quiz5',
                title: '”®—Ç–∫–µ–Ω —à–∞“õ –µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä—ñ',
                description: '”®—Ç–∫–µ–Ω —à–∞“õ—Ç–∞“ì—ã –µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä–¥—ñ –±—ñ–ª—É —Ç–µ—Å—Ç—ñ.'
            }
        ];

        if (!localStorage.getItem('kazakhQuizLessons')) {
            localStorage.setItem('kazakhQuizLessons', JSON.stringify(defaultQuizLessons));
        }

        async function displayQuizzes() {
            const currentUser = localStorage.getItem('currentUser');
            const quizLessons = JSON.parse(localStorage.getItem('kazakhQuizLessons'));
            const quizList = document.getElementById('quizList');
            let completedQuizzes = [];

            if (currentUser) {
                try {
                    const response = await fetch(`/quizzes/completed/${currentUser}/kazakh`);
                    if (response.ok) {
                        completedQuizzes = await response.json();
                    }
                } catch (error) {
                    console.error('Error fetching completed quizzes:', error);
                }
            }

            quizList.innerHTML = '';
            quizLessons.forEach(quiz => {
                const isCompleted = completedQuizzes.includes(quiz.id);
                const quizElement = document.createElement('div');
                quizElement.className = `quiz-item ${isCompleted ? 'completed' : ''}`;
                quizElement.innerHTML = `
                    <h5>${quiz.title}</h5>
                    <p>${quiz.description}</p>
                    <button onclick="startQuiz('${quiz.id}')" 
                            class="btn btn-primary">
                        ${isCompleted ? '“ö–∞–π—Ç–∞ ”©—Ç—É' : '–ë–∞—Å—Ç–∞—É'}
                    </button>
                `;
                quizList.appendChild(quizElement);
            });
        }

        function startQuiz(quizId) {
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                alert('–¢–µ—Å—Ç—Ç—ñ –±–∞—Å—Ç–∞—É “Ø—à—ñ–Ω –∂“Ø–π–µ–≥–µ –∫—ñ—Ä—ñ“£—ñ–∑');
                window.location.href = '/login';
                return;
            }
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
            alert('–¢–µ—Å—Ç –∂–∞—Å–∞–ª—É “Ø—Å—Ç—ñ–Ω–¥–µ...');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem("theme");
            const body = document.body;
            const modeToggleButton = document.getElementById("modeToggle");

            if (savedTheme) {
                body.classList.remove("light-mode", "dark-mode");
                body.classList.add(savedTheme);
                modeToggleButton.textContent = savedTheme === "dark-mode" ? "üåû" : "üåô";
            }

            modeToggleButton.addEventListener("click", toggleMode);
            displayQuizzes();
        });

        function toggleMode() {
            const body = document.body;
            const modeToggleButton = document.getElementById("modeToggle");
            const isLightMode = body.classList.contains("light-mode");

            if (isLightMode) {
                body.classList.remove("light-mode");
                body.classList.add("dark-mode");
                modeToggleButton.textContent = "üåû";
                localStorage.setItem("theme", "dark-mode");
            } else {
                body.classList.remove("dark-mode");
                body.classList.add("light-mode");
                modeToggleButton.textContent = "üåô";
                localStorage.setItem("theme", "light-mode");
            }
        }
    </script>
</body>
</html> 