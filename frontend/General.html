<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö—É—Ä—Å —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    .wrapper {
      display: flex;
      width: 100%;
      min-height: 100vh;
    }

    .sidebar {
      width: 250px;
      background: #000000;
      color: white;
      padding-top: 80px; /* Space for header */
      position: fixed;
      left: 0;
      height: 100%;
      z-index: 99;
    }

    .main-content {
      margin-left: 250px;
      width: calc(100% - 250px);
      padding: 20px;
      padding-top: 80px; /* Space for header */
    }

    .sidebar-menu {
      padding: 0;
      list-style: none;
    }

    .sidebar-menu li {
      padding: 15px 20px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .sidebar-menu li a {
      color: white;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sidebar-menu li:hover {
      background: rgba(255,255,255,0.1);
    }

    .progress-section {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .progress-bar {
      width: 100%;
      height: 20px;
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }

    .progress-fill {
      height: 100%;
      background: #4CAF50;
      transition: width 0.3s ease;
    }

    .progress-details {
      font-size: 14px;
    }

    .progress-details p {
      margin: 5px 0;
    }

    .current-level {
      background-color: #28a745;
      color: white;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 4px;
    }
  </style>
</head>
<body class="light-mode">

<header class="header py-3">
  <div class="container d-flex justify-content-between">
    <nav class="nav">
      <div class="nav-logo" style="padding-right: 20%">
        <p>STUDY</p>
      </div>
      <div class="nav-menu" id="navMenu">
        <ul>
          <li><a href="/" class="link">Home</a></li>
          <li><a href="/courses" class="link">Courses</a></li>
          <li><a href="/contact" class="link">Contact us</a></li>
        </ul>
      </div>
      <div class="nav-menu" id="navMenuu">
        <div class="nav-button">
          <ul>
            <li><a href="/login" id="Login" class="link">Log In / Sign Up</a></li>
            <li><span id="userGreeting" style="display: none;"></span></li>
          </ul>
        </div>
      </div>
    </nav>
    <button id="modeToggle" class="btn btn-light position-relative top-0 right-0 m-3" onclick="toggleMode()">üåô</button>
    <button class="btn" id="logoutBtn" style="display: flex;" onclick="logout()">Log Out</button>
  </div>
</header>

<div class="wrapper">
  <!-- Sidebar -->
  <nav class="sidebar">
    <div class="progress-section">
      <h6>–ü—Ä–æ–≥—Ä–µ—Å—Å –∫—É—Ä—Å–∞: <span id="totalProgressText">0%</span></h6>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-details">
        <div id="progressText">
          <p>–í–∏–¥–µ–æ: ${videoData.VideosDone}/${videoData.TotalVideos}</p>
          <p>–¢–µ—Å—Ç—ã: ${completedTests}/${totalTests}</p>
        </div>
        <p style="font-weight: bold;" id="levelText">–í–∞—à —É—Ä–æ–≤–µ–Ω—å: –ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω</p>
      </div>
    </div>
    <ul class="sidebar-menu">
      <li>
        <a href="/video">
          <span>üì∫</span> –í–∏–¥–µ–æ—É—Ä–æ–∫–∏
        </a>
      </li>
      <li>
        <a href="/quiz">
          <span>üìù</span> –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        </a>
      </li>
      <li>
        <a href="/russian-quiz">
          <span>üéØ</span> –¢–µ—Å—Ç –Ω–∞ —É—Ä–æ–≤–µ–Ω—å
        </a>
      </li>
    </ul>
  </nav>

  <!-- Main Content -->
  <div class="main-content">
    <div class="container">
      <h1>–ö—É—Ä—Å —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞</h1>
      <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –∫—É—Ä—Å —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞! –ó–¥–µ—Å—å –≤—ã –Ω–∞–π–¥–µ—Ç–µ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è.</p>
      
      <!-- Your existing content here -->
    </div>
  </div>
</div>

<footer class="footer text-center py-3" style="position: relative;">
  <p>SE-2304. All Rights Reserved.</p>
</footer>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
  function toggleMode() {
    const body = document.body;
    const modeToggleButton = document.getElementById("modeToggle");
    const isLightMode = body.classList.contains("light-mode");

    if (isLightMode) {
      body.classList.remove("light-mode");
      body.classList.add("dark-mode");
      modeToggleButton.textContent = "üåû";
      localStorage.setItem("theme", "dark-mode");
    } else {
      body.classList.remove("dark-mode");
      body.classList.add("light-mode");
      modeToggleButton.textContent = "üåô";
      localStorage.setItem("theme", "light-mode");
    }
  }

  window.addEventListener("load", function() {
    const savedTheme = localStorage.getItem("theme");
    const body = document.body;
    const containerDiv = document.getElementById("containerDiv");
    const modeToggleButton = document.getElementById("modeToggle");

    if (savedTheme) {
      body.classList.remove("light-mode", "dark-mode");
      body.classList.add(savedTheme);
      containerDiv.classList.remove("light-mode", "dark-mode");
      containerDiv.classList.add(savedTheme);

      if (savedTheme === "dark-mode") {
        modeToggleButton.textContent = "üåû";
      } else {
        modeToggleButton.textContent = "üåô";
      }
    } else {
      body.classList.add("light-mode");
      containerDiv.classList.add("light-mode");
      modeToggleButton.textContent = "üåô";
    }
  });

  document.getElementById("modeToggle").addEventListener("click", toggleMode);
  window.onload = function() {
    const currentUser = localStorage.getItem("currentUser");

    if (currentUser) {
      document.getElementById("Login").style.display = "none";
      document.getElementById("userGreeting").style.display = "inline";
      document.getElementById("userGreeting").textContent = `${currentUser}`;
      document.getElementById("logoutBtn").style.display = "inline";
    } else {
      document.getElementById("Login").style.display = "inline";
      document.getElementById("userGreeting").style.display = "none";
      document.getElementById("logoutBtn").style.display = "none";
    }
  }

  function logout() {
    localStorage.removeItem("currentUser");
    document.getElementById("Login").style.display = "inline";
    document.getElementById("userGreeting").style.display = "none";
    document.getElementById("logoutBtn").style.display = "none";
  }

  async function updateProgress() {
    const currentUser = localStorage.getItem('currentUser');
    if (!currentUser) return;

    try {
        const videoResponse = await fetch(`/course/progress/${currentUser}/russian`);
        const videoData = await videoResponse.json();
        
        // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
        let completedTests = 0;
        const totalTests = quizLessons.length;
        
        for (const quiz of quizLessons) {
            const response = await fetch(`/quiz/progress/${currentUser}/${quiz.id}`);
            if (response.ok) {
                const data = await response.json();
                if (data.completed) {
                    completedTests++;
                }
            }
        }

        const levelResponse = await fetch(`/user/progress/${currentUser}`);
        const levelData = await levelResponse.json();

        const totalItems = videoData.TotalVideos + totalTests;
        const completedItems = videoData.VideosDone + completedTests;
        const totalProgress = (completedItems / totalItems) * 100;
        
        document.querySelector('.progress-fill').style.width = `${totalProgress}%`;
        document.getElementById('totalProgressText').textContent = `${Math.round(totalProgress)}%`;

        document.getElementById('progressText').innerHTML = `
            <p>–í–∏–¥–µ–æ: ${videoData.VideosDone}/${videoData.TotalVideos}</p>
            <p>–¢–µ—Å—Ç—ã: ${completedTests}/${totalTests}</p>
        `;

        document.getElementById('levelText').textContent =
            `–í–∞—à —É—Ä–æ–≤–µ–Ω—å: ${levelData.level || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}`;

    } catch (error) {
        console.error('Error updating progress:', error);
    }
  }

  document.addEventListener('DOMContentLoaded', updateProgress);

  function showResources() {
    alert('Resources section coming soon!');
  }

  function showNotes() {
    alert('Notes section coming soon!');
  }

  function showGrammar() {
    alert('–†–∞–∑–¥–µ–ª –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω!');
  }

  function showVocabulary() {
    alert('–†–∞–∑–¥–µ–ª —Å–ª–æ–≤–∞—Ä–Ω–æ–≥–æ –∑–∞–ø–∞—Å–∞ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω!');
  }

  // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Å—Å–∏–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
  const quizLessons = [
      {
          id: 'quiz1',
          title: '–ë–∞–∑–æ–≤–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞',
          description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–Ω–∏–π –±–∞–∑–æ–≤–æ–π –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞.'
      },
      {
          id: 'quiz2',
          title: '–°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ',
          description: '–¢–µ—Å—Ç –Ω–∞ –∑–Ω–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –∏—Ö —Ä–æ–¥–æ–≤.'
      },
      {
          id: 'quiz3',
          title: '–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ',
          description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–Ω–∏–π –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –∏ –∏—Ö —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.'
      },
      {
          id: 'quiz4',
          title: '–ì–ª–∞–≥–æ–ª—ã –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏',
          description: '–¢–µ—Å—Ç –Ω–∞ —Å–ø—Ä—è–∂–µ–Ω–∏–µ –≥–ª–∞–≥–æ–ª–æ–≤ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º –≤—Ä–µ–º–µ–Ω–∏.'
      },
      {
          id: 'quiz5',
          title: '–ì–ª–∞–≥–æ–ª—ã –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏',
          description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–Ω–∏–π –≥–ª–∞–≥–æ–ª–æ–≤ –≤ –ø—Ä–æ—à–µ–¥—à–µ–º –≤—Ä–µ–º–µ–Ω–∏.'
      }
  ];
</script>

</body>
</html>
